const LANG_CONFIG = {
    ar: {
        dir: 'rtl',
        lang: 'ar',
        name: 'ÿßŸÑÿπÿ±ÿ®Ÿäÿ©',
        btn: 'English üá∫üá∏',
        translations: {
            "nav_home": "üè† ÿßŸÑÿ±ÿ¶Ÿäÿ≥Ÿäÿ©",
            "nav_about": "‚ÑπÔ∏è ÿπŸÜ ÿßŸÑŸÖŸÜÿµÿ©",
            "nav_new": "‚ú® ÿßŸÑÿ¨ÿØŸäÿØ",
            "nav_lib": "üìö ÿßŸÑŸÖŸÉÿ™ÿ®ÿ©",
            "nav_saved": "üìÅ ÿßŸÑŸÖÿ≠ŸÅŸàÿ∏ÿßÿ™",
            "nav_cv": "üìÑ ÿßŸÑÿ≥Ÿäÿ±ÿ© ÿßŸÑÿ∞ÿßÿ™Ÿäÿ©",
            "nav_cv_pro": "üé® ÿ≥Ÿäÿ±ÿ© ÿßÿ≠ÿ™ÿ±ÿßŸÅŸäÿ© (Paid)",
            "nav_cv_ats": "üìÑ ÿ≥Ÿäÿ±ÿ© ATS (Paid)",
            "nav_refine": "‚ö° ÿßŸÑŸÖŸÜŸÇÿ≠ ÿßŸÑÿ∞ŸÉŸä",
            "refine_title": "‚úçÔ∏è ÿßŸÑŸÖÿ∑Ÿàÿ± ŸàÿßŸÑŸÖŸÜŸÇÿ≠ ÿßŸÑÿ™ŸÅÿßÿπŸÑŸä V3.0",
            "refine_subtitle": "ÿ™ÿ≠ŸÑŸäŸÑ ÿ∞ŸÉŸä ŸÑŸÑŸÅÿ¨Ÿàÿßÿ™ Ÿàÿ™ÿ≠ÿ≥ŸäŸÜÿßÿ™ ÿ™ŸÅÿßÿπŸÑŸäÿ© ŸÖÿÆÿµÿµÿ©",
            "step_upload": "ÿ±ŸÅÿπ ÿßŸÑŸÖŸÑŸÅÿßÿ™",
            "step_analysis": "ÿßŸÑÿ™ÿ≠ŸÑŸäŸÑ ÿßŸÑŸÖŸÇÿßÿ±ŸÜ",
            "step_improve": "ÿßÿÆÿ™Ÿäÿßÿ± ÿßŸÑÿ™ÿ≠ÿ≥ŸäŸÜÿßÿ™",
            "step_review": "ÿßŸÑŸÖÿ±ÿßÿ¨ÿπÿ© ÿßŸÑŸÜŸáÿßÿ¶Ÿäÿ©",
            "ai_output": "üíé ŸÖÿÆÿ±ÿ¨ÿßÿ™ ŸÖŸÜÿµÿ© ÿ£ÿ´ÿ± V3.0",
            "jobs_title": "ÿßŸÑŸàÿ∏ÿßÿ¶ŸÅ ÿßŸÑÿ¥ÿßÿ∫ÿ±ÿ©",
            "jobs_search": "ÿßÿ®ÿ≠ÿ´ ÿπŸÜ ŸÅÿ±ÿµÿ©...",
            "major_updates": "ÿßŸÑÿ™ÿ≠ÿ≥ŸäŸÜÿßÿ™ ÿßŸÑÿ±ÿ¶Ÿäÿ≥Ÿäÿ©",
            "saved_title": "üìÅ ÿßŸÑŸÖŸÑŸÅÿßÿ™ ÿßŸÑŸÖÿ≠ŸÅŸàÿ∏ÿ© ŸÖÿ≠ŸÑŸäÿßŸã",


            "hero_title": "ÿ£ÿ´ŸÄŸÄŸÄŸÄŸÄÿ±",
            "hero_slogan": "ÿ£ÿ´ÿ± | ŸÑÿ£ŸÜ ÿßŸÑÿ™ÿ∫ŸäŸäÿ± Ÿäÿ®ÿØÿ£ ÿ®ÿÆÿ∑ÿ©",
            "step1_title": "1. ÿ™ÿ≠ŸÑŸäŸÑ ÿßŸÑÿ®ŸäÿßŸÜÿßÿ™",
            "step2_title": "2. ÿ™ŸàŸÑŸäÿØ ÿßŸÑÿ£ŸÅŸÉÿßÿ±",
            "step3_title": "3. ŸÉÿ™ÿßÿ®ÿ© ÿßŸÑŸÖŸÇÿ™ÿ±ÿ≠",
            "step4_title": "4. ÿßŸÑŸÖŸàÿßÿ≤ŸÜÿ©",
            "step5_title": "5. ÿßŸÑÿ™ÿµÿØŸäÿ±",
            "analyze_h2": "üí° ÿßÿ®ÿØÿ£ ŸÅŸÉÿ±ÿ™ŸÉ ŸáŸÜÿß",
            "analyze_p": "ÿ£ÿØÿÆŸÑ ŸÅŸÉÿ±ÿ© ŸÖÿ®ÿØÿ¶Ÿäÿ© ÿ£Ÿà ÿßÿ±ŸÅÿπ ŸÖŸÑŸÅ (ÿ•ÿπŸÑÿßŸÜ ŸÖŸÜÿ≠ÿ© / RFP) ŸÑŸäŸÇŸàŸÖ ÿßŸÑŸÜÿ∏ÿßŸÖ ÿ®ÿ™ÿ≠ŸÑŸäŸÑŸá.",
            "label_idea": "ŸÅŸÉÿ±ÿ© ÿßŸÑŸÖÿ¥ÿ±Ÿàÿπ / ÿßŸÑŸÖÿ¥ŸÉŸÑÿ©:",
            "ph_idea": "ŸÖÿ´ÿßŸÑ: ŸÖÿ¥ÿ±Ÿàÿπ ÿØÿπŸÖ ÿ™ÿπŸÑŸäŸÖŸä ŸÑŸÑÿ£ÿ∑ŸÅÿßŸÑ ÿßŸÑŸÖÿ™ÿ≥ÿ±ÿ®ŸäŸÜ ŸÅŸä ÿ±ŸäŸÅ ÿ≠ŸÑÿ®...",
            "search_placeholder": "ÿßÿ®ÿ≠ÿ´ ÿπŸÜ ŸÉÿ™ÿßÿ®ÿå ÿØŸÑŸäŸÑÿå ÿ£Ÿà ŸÖŸàÿ±ÿØ...",
            "lib_syncing": "ÿ¨ÿßÿ±Ÿä ÿßŸÑŸÖÿ≤ÿßŸÖŸÜÿ© ŸÖÿπ Google Drive...",
            "lib_sync_success": "ÿ™ŸÖÿ™ ÿßŸÑŸÖÿ≤ÿßŸÖŸÜÿ© ÿ®ŸÜÿ¨ÿßÿ≠!",
            "lib_sync_fail": "ŸÅÿ¥ŸÑÿ™ ÿßŸÑŸÖÿ≤ÿßŸÖŸÜÿ©. ÿ™ÿ£ŸÉÿØ ŸÖŸÜ ÿ•ÿπÿØÿßÿØÿßÿ™ Bridge.",
            "label_budget": "ÿßŸÑŸÖŸäÿ≤ÿßŸÜŸäÿ© ÿßŸÑŸÖÿ™ŸàŸÅÿ±ÿ© ($):",
            "label_duration": "ÿßŸÑŸÖÿØÿ© (ÿ£ÿ¥Ÿáÿ±):",
            "label_country": "ÿßŸÑÿØŸàŸÑÿ© ÿßŸÑŸÖÿ≥ÿ™ŸáÿØŸÅÿ©:",
            "label_file": "ÿ£Ÿà ÿßÿ±ŸÅÿπ ŸÖŸÑŸÅ ÿßŸÑÿ•ÿπŸÑÿßŸÜ (PDF/DOCX):",
            "btn_analyze": "ÿ™ÿ≠ŸÑŸäŸÑ ÿßŸÑŸÅŸÉÿ±ÿ© ‚ö°",
            "sec_ideas_title": "‚ú® ÿßŸÑÿ£ŸÅŸÉÿßÿ± ÿßŸÑŸÖŸÇÿ™ÿ±ÿ≠ÿ©",
            "sec_ideas_p": "ÿ®ŸÜÿßÿ°Ÿã ÿπŸÑŸâ ÿ™ÿ≠ŸÑŸäŸÑŸÉÿå ÿ•ŸÑŸäŸÉ ÿ£ŸÅÿ∂ŸÑ ÿßŸÑÿ£ŸÅŸÉÿßÿ± ÿßŸÑŸÖÿ™ŸàÿßŸÅŸÇÿ© ŸÖÿπ ÿßŸÑŸÖÿπÿßŸäŸäÿ±:",
            "btn_generate_prop": "ŸÉÿ™ÿßÿ®ÿ© ÿßŸÑŸÖŸÇÿ™ÿ±ÿ≠ ÿßŸÑŸÉÿßŸÖŸÑ üìù",
            "sec_budget_title": "üí∞ ÿßŸÑŸÖŸäÿ≤ÿßŸÜŸäÿ© ÿßŸÑÿ™ŸÅÿµŸäŸÑŸäÿ©",
            "btn_export_word": "üìÑ ÿ™ÿµÿØŸäÿ± Word",
            "btn_export_excel": "üìä ÿ™ÿµÿØŸäÿ± Excel",
            "btn_save": "üíæ ÿ≠ŸÅÿ∏ ÿßŸÑŸÖÿ¥ÿ±Ÿàÿπ",
            "nav_ops": "üè¢ ÿÆÿØŸÖÿßÿ™ ÿßŸÑŸÖŸÜÿ∏ŸÖÿßÿ™",
            "nav_admin": "üõ†Ô∏è ŸÑŸàÿ≠ÿ© ÿßŸÑÿ•ÿØÿßÿ±ÿ©",
            "nav_logout": "ÿÆÿ±Ÿàÿ¨ üö™",
            "btn_start": "ÿßÿ®ÿØÿ£ ÿßŸÑÿ¢ŸÜ üöÄ",
            "footer_credit": "ÿ™ÿ∑ŸàŸäÿ± Ÿàÿ™ŸÜŸÅŸäÿ∞ ÿ£. ŸÜÿ®ŸäŸÑ ÿßŸÑÿ≠ŸÖŸäÿØ"
        }
    },
    en: {
        dir: 'ltr',
        lang: 'en',
        name: 'English',
        btn: 'ÿßŸÑÿπÿ±ÿ®Ÿäÿ© üá∏üá¶',
        translations: {
            "nav_home": "üè† Home",
            "nav_about": "‚ÑπÔ∏è About",
            "nav_new": "‚ú® What's New",
            "nav_lib": "üìö Library",
            "nav_saved": "üìÅ Saved Files",
            "nav_ops": "üè¢ Org Services",
            "nav_admin": "üõ†Ô∏è Admin Panel",
            "nav_logout": "Logout üö™",
            "btn_start": "Start Now üöÄ",
            "nav_cv": "üìÑ CV Maker",
            "nav_cv_pro": "üé® Pro CV (Paid)",
            "nav_cv_ats": "üìÑ ATS CV (Paid)",
            "nav_refine": "‚ö° Smart Refiner",
            "refine_title": "‚úçÔ∏è Interactive Refiner V3.0",
            "refine_subtitle": "Smart gap analysis and interactive improvements",
            "step_upload": "Upload",
            "step_analysis": "Analysis",
            "step_improve": "Improvements",
            "step_review": "Final Review",
            "ai_output": "üíé Athar Platform Output",
            "jobs_title": "Job Vacancies",
            "jobs_search": "Search for jobs...",
            "major_updates": "Major Improvements",
            "saved_title": "üìÅ Locally Saved Files",


            "hero_title": "ATHAR",
            "hero_slogan": "Athar | Change Starts with a Plan",
            "step1_title": "1. Analysis",
            "step2_title": "2. Ideas",
            "step3_title": "3. Proposal",
            "step4_title": "4. Budget",
            "step5_title": "5. Export",
            "analyze_h2": "üí° Start Your Idea",
            "analyze_p": "Enter an initial idea or upload a file (Grant Ad / RFP) for system analysis.",
            "label_idea": "Project Idea / Problem:",
            "ph_idea": "Ex: Educational support for drop-out children in Aleppo...",
            "search_placeholder": "Search for resources, guides...",
            "lib_syncing": "Syncing with Google Drive...",
            "lib_sync_success": "Sync Successful!",
            "lib_sync_fail": "Sync Failed. Check Bridge settings.",
            "label_budget": "Budget ($):",
            "label_duration": "Duration (Months):",
            "label_country": "Target Country:",
            "label_file": "Or upload file (PDF/DOCX):",
            "btn_analyze": "Analyze Idea ‚ö°",
            "sec_ideas_title": "‚ú® Suggested Ideas",
            "sec_ideas_p": "Based on analysis, here are the best compliant ideas:",
            "btn_generate_prop": "Write Full Proposal üìù",
            "sec_budget_title": "üí∞ Detailed Budget",
            "btn_export_word": "üìÑ Export Word",
            "btn_export_excel": "üìä Export Excel",
            "btn_save": "üíæ Save Project",
            "footer_credit": "Developed by: Nabel Al-Hameed"
        }
    }
};

class LanguageManager {
    constructor() {
        this.currentLang = localStorage.getItem('athar_language') || 'ar';
        this.applyLanguage(this.currentLang);
    }

    toggleLanguage() {
        this.currentLang = this.currentLang === 'ar' ? 'en' : 'ar';
        localStorage.setItem('athar_language', this.currentLang);
        location.reload();
    }

    applyLanguage(lang) {
        const config = LANG_CONFIG[lang];
        document.documentElement.dir = config.dir;
        document.documentElement.lang = config.lang;

        // Update basic static elements if they exist
        document.addEventListener('DOMContentLoaded', () => {
            this.updateUIText(config.translations);
            const toggleBtn = document.getElementById('globalLangToggle');
            if (toggleBtn) toggleBtn.innerText = config.btn;
        });
    }

    updateUIText(translations) {
        document.querySelectorAll('[data-i18n]').forEach(el => {
            const key = el.getAttribute('data-i18n');
            if (translations[key]) {
                if (el.tagName === 'INPUT' || el.tagName === 'TEXTAREA') {
                    el.placeholder = translations[key];
                } else {
                    el.innerText = translations[key];
                }
            }
        });
    }

    get(key) {
        return LANG_CONFIG[this.currentLang].translations[key] || key;
    }

    getLang() {
        return this.currentLang;
    }
}

const LangManager = new LanguageManager();

// üõ†Ô∏è Auto-Load Expert Review Manager (Global)
(function () {
    const script = document.createElement('script');
    script.src = 'js/modules/expert_review.js';
    script.async = true;
    document.head.appendChild(script);
})();
